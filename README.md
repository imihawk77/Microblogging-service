# Описание проекта "Twitter-clone"
Проект представляет собой backend-составляющую (API для twitter-подобного приложения) с 
возможностью постить твиты с картинкой, ставить лайк, удалять лайк, просматривать данные 
о себе и других пользователях, подписываться на других пользователей и просматривать ленту твитов.

Лента твитов отсортированных в порядке убывания по популярности от пользователей, которых 
пользователь читает.

Требования регистрации пользователя нет: это корпоративная сеть и пользователи будут 
создаваться не нами. Но нам нужно уметь отличать одного пользователя от другого.
Аутентификация пользователей осуществляется через **токен "api-key" в header**.

## Стэк
* **Python** (3.12);
* **FastApi** (асинхронный веб-фрэймворк);
* **Docker** and **Docker Compose** (контейнеризация);
* **PostgreSQL** (СУБД);
* **SQLAlchemy** (управление базами данных для Python);
* **Pydantic** (верификация данных);
* **Pytest** (тесты);
* **Nginx** (связующий сервер между FastAPI приложением и статическими данными - фронтенда).

## Сборка и запуск приложения

1. Скачиваем содержимое репозитория в отдельную папку:
    ```
    https://gitlab.skillbox.ru/igor_miasoedov/python_advanced_diploma
    ```
2. Необходимо подготовить файлы переменных сред. В репозитории есть файл **.env** из которого 
   нужно сделать файл **.env** подставив туда данные (имя пользователя, пароль, имя докер-контейнера,
   порт и имя базы данных) 
   Один файл оставить в корне проекта (он понадобится для docker-compose.yaml), вторую копию поместить
   в src.
   
   db_host и имя контейнера postgres должны совпадать

   ![](/screenshots/db_host.png) 


3. Собираем и запускаем контейнеры с приложением. В терминале в общей директории (с файлом "docker-compose.yml") 
вводим команду:
    ```
    sudo docker-compose up -d
    ```

## После первого запуска приложения необходимо закомментировать следующий код в файле src/main.png:
   ![](/screenshots/main.png)  
   Иначе после перезапуска приложения база данных будет перезаписана и данные не сохранятся.

   Если удаленный компьютер настроен правильно, то запуск приложения укладывается в 
   несколько команд:  
![](/screenshots/docker_up.png)

   Результат выполнения должен отразиться по адресу http://127.0.0.1


4. Для тестирования приложения нужно зайти "внутрь" контейнера путем запуска команды:
    ```
    docker exec -it clone_twitter_app_container /bin/bash
    ```
   и выполнить команду:
   ```
    pytest -v
    ```
   Узнать <container_name> контейнера можно командой:
   ```
    docker ps 
    ```

   Результат выполнения тестов:
   ![](/screenshots/pytest.png)
5. Так как приложение выполняется в качестве "демона" (в фоновом режиме), то мы не можем его завершить 
   путем нажатия Ctrl+C. Нужно зайти в директорию с проектом и ввести команду
    ```
    docker compose stop 
    ```
   ![](/screenshots/docker_stop.png)
### Документация
## Документация

После сборки и запуска приложения ознакомиться с документацией API можно по адресу:
    ```
    http://127.0.0.1:8000/docs
![](/screenshots/documentation.png)
